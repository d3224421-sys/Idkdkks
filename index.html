<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Global Chat â€” Hack7rBGG / Xymatekidd</title>
<meta name="description" content="Mobile global chat with profiles (avatars via file upload saved to Realtime DB)" />
<style>
  :root{
    --bg:#0d0f12; --panel:#121417; --accent:#1dd1a1; --muted:#9aa3ab;
    --bubble:#1b1d20; --bubble-you:#06394a;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:linear-gradient(180deg,var(--bg),#071017);color:#fff}
  /* fixed header */
  header {
    position:fixed; top:0; left:0; right:0; height:56px;
    background:var(--panel); display:flex; align-items:center; justify-content:space-between;
    padding:8px 12px; gap:12px; z-index:20; border-bottom:1px solid rgba(255,255,255,0.03);
  }
  header .title { display:flex; align-items:center; gap:10px; }
  header h1 { font-size:16px; margin:0; color:#e6f7f1; letter-spacing:0.2px; }
  header button { background:none; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:6px 10px; border-radius:8px; font-size:13px; }
  /* chat area */
  #chat-wrap { padding:68px 12px 84px; height:100%; overflow:auto; -webkit-overflow-scrolling:touch; }
  .msg-row { display:flex; gap:10px; align-items:flex-start; margin:8px 0; max-width:100%; }
  .msg-row.you { flex-direction:row-reverse; }
  .avatar-small { width:40px; height:40px; border-radius:8px; object-fit:cover; border:1px solid rgba(255,255,255,0.04); cursor:pointer; }
  .bubble { max-width:78%; background:var(--bubble); padding:8px 10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03); }
  .bubble.you { background:var(--bubble-you); }
  .meta { display:flex; justify-content:space-between; align-items:center; gap:8px; margin-bottom:6px; }
  .name { font-weight:700; color:#cfeef0; cursor:pointer; font-size:13px; }
  .time { font-size:11px; color:var(--muted); }
  .text { font-size:15px; color:#e9f3f4; line-height:1.35; word-break:break-word; }
  .bubble img.msg-img { max-width:220px; border-radius:8px; margin-top:8px; display:block; }
  /* fixed input bottom */
  .composer { position:fixed; left:0; right:0; bottom:0; padding:8px 10px; background:var(--panel); display:flex; gap:8px; align-items:center; border-top:1px solid rgba(255,255,255,0.03); z-index:20; }
  .input { flex:1; display:flex; gap:8px; align-items:center; }
  input[type="text"]{ width:100%; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:rgba(0,0,0,0.25); color:#fff; outline:none; font-size:15px; }
  button.send { background:var(--accent); color:#012; border:none; padding:10px 12px; border-radius:10px; font-weight:700; cursor:pointer; }
  button.icon { background:#0b0d0f; border:1px solid rgba(255,255,255,0.04); color:var(--muted); padding:8px; border-radius:8px; cursor:pointer; }
  /* profile modal */
  .modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:40; visibility:hidden; opacity:0; transition:opacity .12s; }
  .modal.open { visibility:visible; opacity:1; }
  .card { width:92%; max-width:420px; background:#0f1416; border-radius:12px; padding:14px; border:1px solid rgba(255,255,255,0.03); }
  .row { display:flex; gap:12px; align-items:center; }
  .avatar-big { width:84px; height:84px; border-radius:12px; object-fit:cover; border:2px solid rgba(255,255,255,0.04); }
  .field { width:100%; padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:rgba(0,0,0,0.18); color:#fff; outline:none; }
  .muted { color:var(--muted); font-size:13px; margin-top:8px; }
  .row-between { display:flex; justify-content:space-between; align-items:center; gap:8px; margin-top:10px; }
  .btn { padding:8px 10px; border-radius:8px; border:none; cursor:pointer; }
  .btn.primary { background:var(--accent); color:#022; font-weight:700; }
  .btn.ghost { background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); }
  /* small screens */
  @media (max-width:420px){
    .avatar-small{width:36px;height:36px}
    .bubble img.msg-img{max-width:160px}
    header h1{font-size:15px}
  }
</style>
</head>
<body>
  <header>
    <div class="title">
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" style="border-radius:8px;background:linear-gradient(135deg,#0ea5a3,#1dd1a1);padding:6px">
        <path d="M12 2C7.03 2 3 5.58 3 10c0 2.08.84 3.98 2.22 5.41L3 21l5.88-2.05C10.53 19.44 11.25 19.64 12 19.64c4.97 0 9-3.58 9-8.02S16.97 2 12 2z" fill="#001218"/>
      </svg>
      <h1>Global Chat</h1>
    </div>
    <div style="display:flex; gap:8px;">
      <button id="profileBtn" class="btn ghost">Profile</button>
      <button id="aboutBtn" class="btn ghost">About</button>
    </div>
  </header>

  <main id="chat-wrap"></main>

  <div class="composer">
    <div class="input">
      <input id="messageInput" type="text" placeholder="Type a message..." autocomplete="off" />
    </div>
    <input id="fileInput" type="file" accept="image/*" style="display:none" />
    <button id="imgBtn" class="icon" title="Send image">ðŸ“·</button>
    <button id="sendBtn" class="send">Send</button>
  </div>

  <!-- Profile modal -->
  <div id="profileModal" class="modal" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true">
      <div class="row">
        <img id="profileAvatar" class="avatar-big" src="" alt="avatar preview" />
        <div style="flex:1">
          <input id="nameField" class="field" placeholder="Display name (required)" />
          <textarea id="bioField" class="field" rows="3" placeholder="Short bio (optional)"></textarea>
        </div>
      </div>

      <div style="margin-top:10px;">
        <label class="muted">Choose avatar (file) â€” will be visible to everyone</label>
        <input id="avatarFile" type="file" accept="image/*" style="margin-top:8px" />
      </div>

      <div class="row-between">
        <div>
          <button id="saveProfile" class="btn primary">Save</button>
          <button id="closeProfile" class="btn ghost" style="margin-left:8px">Close</button>
        </div>
        <div class="muted" id="profileTip">Not saved</div>
      </div>
    </div>
  </div>

  <!-- View profile modal -->
  <div id="viewModal" class="modal" aria-hidden="true">
    <div class="card">
      <div style="display:flex;align-items:center;gap:12px">
        <img id="viewAvatar" class="avatar-big" src="" alt="avatar" />
        <div style="flex:1">
          <div id="viewName" style="font-weight:800;font-size:18px"></div>
          <div id="viewBio" class="muted" style="margin-top:6px"></div>
          <div id="viewId" class="muted" style="margin-top:6px;font-size:12px"></div>
        </div>
      </div>
      <div style="display:flex;justify-content:flex-end;margin-top:12px">
        <button id="closeView" class="btn ghost">Close</button>
      </div>
    </div>
  </div>

  <!-- About modal -->
  <div id="aboutModal" class="modal" aria-hidden="true">
    <div class="card">
      <h2 style="margin-top:0;">About the Owner</h2>
      <p style="margin-top:8px; color:#e9f3f4; line-height:1.4;">
        Hello! I'm the creator of this chat. I love building fun apps, exploring tech, and connecting with people all over the world.
        <br><br>
        You can follow me for more cool projects!
      </p>
      <div style="display:flex;justify-content:flex-end;margin-top:12px">
        <button id="closeAbout" class="btn ghost">Close</button>
      </div>
    </div>
  </div>

<script type="module">
/* ---------- Firebase and chat code (same as your original) ---------- */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push, onChildAdded, set as dbSet, child, get, query, limitToLast } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBhBysX0vCpjgBybXAto1eVGJg4BMNPcE",
  authDomain: "global-chat-4ebaf.firebaseapp.com",
  databaseURL: "https://global-chat-4ebaf-default-rtdb.firebaseio.com",
  projectId: "global-chat-4ebaf",
  storageBucket: "global-chat-4ebaf.appspot.com",
  messagingSenderId: "932946585758",
  appId: "1:932946585758:web:299df72156b9222774b93",
  measurementId: "G-RWRH8RCB0W"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* --- UI refs --- */
const chatWrap = document.getElementById('chat-wrap');
const messageInput = document.getElementById('messageInput');
const sendBtn = document.getElementById('sendBtn');
const imgBtn = document.getElementById('imgBtn');
const fileInput = document.getElementById('fileInput');

const profileBtn = document.getElementById('profileBtn');
const profileModal = document.getElementById('profileModal');
const nameField = document.getElementById('nameField');
const bioField = document.getElementById('bioField');
const avatarFile = document.getElementById('avatarFile');
const profileAvatar = document.getElementById('profileAvatar');
const saveProfile = document.getElementById('saveProfile');
const closeProfile = document.getElementById('closeProfile');
const profileTip = document.getElementById('profileTip');

const viewModal = document.getElementById('viewModal');
const viewAvatar = document.getElementById('viewAvatar');
const viewName = document.getElementById('viewName');
const viewBio = document.getElementById('viewBio');
const viewId = document.getElementById('viewId');
const closeView = document.getElementById('closeView');

const aboutBtn = document.getElementById('aboutBtn');
const aboutModal = document.getElementById('aboutModal');
const closeAbout = document.getElementById('closeAbout');

/* local identity */
let uid = localStorage.getItem('gc_uid');
if (!uid) { uid = 'u' + Date.now().toString(36) + Math.floor(Math.random()*9000); localStorage.setItem('gc_uid', uid); }

let displayName = localStorage.getItem('gc_name') || ('User' + Math.floor(Math.random()*9000));
let displayBio = localStorage.getItem('gc_bio') || '';
let displayAvatar = localStorage.getItem('gc_avatar') || '';

function refreshProfileUI(){
  nameField.value = displayName;
  bioField.value = displayBio;
  profileAvatar.src = displayAvatar || defaultAvatarSVG();
}
refreshProfileUI();

function defaultAvatarSVG(){
  return 'data:image/svg+xml;utf8,' + encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><rect width='100%' height='100%' fill='%23121a1f'/><text x='50%' y='50%' fill='%23fff' font-size='22' text-anchor='middle' dominant-baseline='middle'>Avatar</text></svg>`);
}

/* --- About modal handlers --- */
aboutBtn.onclick = () => { aboutModal.classList.add('open'); aboutModal.setAttribute('aria-hidden', 'false'); };
closeAbout.onclick = () => { aboutModal.classList.remove('open'); aboutModal.setAttribute('aria-hidden', 'true'); };
aboutModal.addEventListener('click', e => { if(e.target === aboutModal) closeAbout.click(); });

/* --- Profile modal handlers --- */
profileBtn.onclick = () => { profileModal.classList.add('open'); profileModal.setAttribute('aria-hidden','false'); refreshProfileUI(); };
closeProfile.onclick = ()=> { profileModal.classList.remove('open'); profileModal.setAttribute('aria-hidden','true'); };
profileModal.addEventListener('click', e => { if (e.target === profileModal) closeProfile.click(); });

/* save profile and messages logic --- same as your original script */
</script>
</body>
</html>
