<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Global Chat</title>
<style>
  :root{
    --bg1:#0f1720;
    --bg2:#182031;
    --card:#16171a;
    --accent:#00e0ff;
  }

  html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:
    linear-gradient(180deg,var(--bg1),var(--bg2));color:#fff;-webkit-font-smoothing:antialiased;}

  .wrap{
    min-height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:20px;
    box-sizing:border-box;
  }

  .app {
    width:100%;
    max-width:720px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.04);
    border-radius:14px;
    padding:14px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.6);
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  .header {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }

  .title {
    display:flex;
    align-items:center;
    gap:12px;
  }

  .logo {
    width:44px;height:44px;border-radius:10px;
    background:linear-gradient(135deg,#00e0ff,#7b61ff);
    display:flex;align-items:center;justify-content:center;font-weight:700;color:#072;
    box-shadow:0 6px 18px rgba(123,97,255,0.12);
  }

  h1{font-size:18px;margin:0;}
  p.sub{margin:0;color:#9aa3b2;font-size:13px}

  /* rainbow credit */
  .credit {
    font-weight:700;
    font-size:13px;
    padding:8px 12px;
    border-radius:999px;
    background:linear-gradient(90deg,#ff2d55,#ff7a18,#ffd600,#00e676,#00b0ff,#8e44ff);
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
    animation: rainbowShift 4s linear infinite;
    filter: drop-shadow(0 2px 8px rgba(0,0,0,0.4));
    transform-origin:center;
  }

  @keyframes rainbowShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* chat area */
  #chat-box {
    width:100%;
    height:62vh;
    min-height:360px;
    max-height:78vh;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.03);
    border-radius:10px;
    padding:12px;
    overflow:auto;
    box-sizing:border-box;
    scroll-behavior:smooth;
  }

  .msg {
    display:block;
    margin:8px 0;
    max-width:86%;
    padding:10px 12px;
    border-radius:10px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.15));
    border:1px solid rgba(255,255,255,0.03);
    color:#e6eef7;
    box-shadow: 0 6px 18px rgba(0,0,0,0.45);
    animation: msgIn .28s ease;
  }

  .msg.you{
    margin-left:auto;
    background:linear-gradient(180deg, rgba(0,188,212,0.12), rgba(0,188,212,0.06));
    border:1px solid rgba(0,188,212,0.12);
  }

  .meta {
    display:flex;
    justify-content:space-between;
    gap:8px;
    margin-bottom:6px;
    align-items:center;
  }

  .name {
    font-weight:700;
    color:#bfefff;
    font-size:13px;
  }

  .time { font-size:11px;color:#9aa3b2; }

  .text { font-size:15px; line-height:1.35; color:#f3f7fb; word-break:break-word; }

  @keyframes msgIn {
    from { transform: translateY(6px) scale(.995); opacity:0; }
    to { transform: translateY(0) scale(1); opacity:1; }
  }

  /* input area */
  .footer {
    display:flex;
    align-items:center;
    gap:10px;
  }

  .input {
    flex:1;
    display:flex;
    gap:8px;
    align-items:center;
  }

  .input input[type="text"]{
    width:100%;
    padding:12px 14px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.06);
    background:rgba(0,0,0,0.25);
    color:#fff;
    outline:none;
    font-size:15px;
  }

  .send {
    padding:12px 14px;
    border-radius:10px;
    border:none;
    background:linear-gradient(90deg,#00e0ff,#7b61ff);
    color:#071028;
    font-weight:700;
    cursor:pointer;
    box-shadow:0 8px 24px rgba(123,97,255,0.12);
    transition:transform .08s ease;
  }
  .send:active{ transform:translateY(1px) scale(.995); }

  /* small credit footer */
  .footer-credit {
    display:flex;align-items:center;gap:8px;justify-content:space-between;margin-top:6px;
  }

  .madeby {
    font-size:13px;color:#9aa3b2;
  }

  .rain-border {
    border-radius:999px;padding:6px 10px;background:linear-gradient(90deg,#ff2d55,#ff7a18,#ffd600,#00e676,#00b0ff,#8e44ff);
    -webkit-background-clip:text;background-clip:text;color:transparent;
    font-weight:700;
  }

  /* small screens adjustments */
  @media (max-width:420px){
    .app{ padding:10px; border-radius:12px; }
    #chat-box{ height:64vh; min-height:320px; }
    h1{font-size:16px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="app" role="application" aria-label="Global Chat">
      <div class="header">
        <div class="title">
          <div class="logo">GC</div>
          <div>
            <h1>Global Chat</h1>
            <p class="sub">Realtime chat â€” everyone sees it. Be nice :)</p>
          </div>
        </div>

        <!-- Rainbow animated credit -->
        <div class="credit" title="Creator">Hack7rBGG / Xymatekidd</div>
      </div>

      <div id="chat-box" aria-live="polite"></div>

      <div class="footer">
        <div class="input">
          <input id="messageInput" type="text" inputmode="text" autocomplete="off" placeholder="Type a message..." />
        </div>
        <button id="sendBtn" class="send" aria-label="Send message">Send</button>
      </div>

      <div class="footer-credit">
        <div class="madeby">Built by <span class="rain-border">Hack7rBGG / Xymatekidd</span></div>
        <div style="font-size:12px;color:#8d9bb0;">Mobile-ready</div>
      </div>
    </div>
  </div>

  <!-- Firebase modular SDK (no backend required). Uses your project's config below. -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded, query, limitToLast } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    // ---- YOUR FIREBASE CONFIG (already filled) ----
    const firebaseConfig = {
      apiKey: "AIzaSyBhBysX0vCpjgBybXAto1eVGJg4BMNPcE",
      authDomain: "global-chat-4ebaf.firebaseapp.com",
      databaseURL: "https://global-chat-4ebaf-default-rtdb.firebaseio.com",
      projectId: "global-chat-4ebaf",
      storageBucket: "global-chat-4ebaf.appspot.com",
      messagingSenderId: "932946585758",
      appId: "1:932946585758:web:299df72156b9222774b93"
    };
    // -----------------------------------------------

    // init
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // UI refs
    const chatBox = document.getElementById('chat-box');
    const msgInput = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');

    // generate or reuse a persistent username for this browser session
    let username = localStorage.getItem('gc_username');
    if (!username) {
      username = 'User' + Math.floor(Math.random() * 9000 + 1000);
      localStorage.setItem('gc_username', username);
    }

    // send message (enter key + button)
    function sendMessage(){
      const text = (msgInput.value || '').trim();
      if (!text) return;
      const messagesRef = ref(db, 'messages');
      push(messagesRef, {
        name: username,
        text: text,
        time: Date.now()
      }).catch(e => console.error('push err', e));
      msgInput.value = '';
      msgInput.focus();
    }

    sendBtn.addEventListener('click', sendMessage);
    msgInput.addEventListener('keydown', (e)=> {
      if (e.key === 'Enter') sendMessage();
    });

    // helper to format time
    function formatTime(ts){
      try {
        const d = new Date(ts);
        return d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
      } catch(e){ return ''; }
    }

    // render message
    function renderMessage(msg){
      const wrapper = document.createElement('div');
      wrapper.className = 'msg' + (msg.name === username ? ' you' : '');
      wrapper.innerHTML = `
        <div class="meta">
          <div class="name">${escapeHtml(msg.name)}</div>
          <div class="time">${msg.timeFormatted || ''}</div>
        </div>
        <div class="text">${escapeHtml(msg.text)}</div>
      `;
      chatBox.appendChild(wrapper);
      // keep only last ~300 messages rendered for performance
      while (chatBox.children.length > 350) chatBox.removeChild(chatBox.firstChild);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // simple escape
    function escapeHtml(s=''){
      return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }

    // realtime listener (last 200 messages)
    const q = query(ref(db,'messages'), limitToLast(200));
    onChildAdded(q, snap => {
      const data = snap.val();
      if (!data) return;
      data.timeFormatted = formatTime(data.time);
      renderMessage(data);
      // subtle highlight animation for new messages (optional)
      const last = chatBox.lastElementChild;
      if (last){
        last.animate([{ transform:'scale(.995)', opacity:0.85 }, { transform:'scale(1)', opacity:1 }], { duration:220, easing:'ease-out' });
      }
    });

    // focus message input on load
    msgInput.focus();
  </script>
</body>
</html>
